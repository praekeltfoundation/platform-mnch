{
  "name": "HelpCentre: Agent Greeting",
  "description": "Default description",
  "uuid": "1558176d-4e4e-4625-b9b4-93c77c1bac92",
  "resources": [
    {
      "values": [
        {
          "value": "@substituted_msg",
          "modes": [
            "RICH_MESSAGING"
          ],
          "content_type": "TEXT",
          "mime_type": "text/plain",
          "language_id": "c8f16db8-7a54-45f8-a102-8eafb4b094ea"
        }
      ],
      "uuid": "ba6857c4-f443-4410-8c31-779a87cb2ee0"
    },
    {
      "values": [
        {
          "value": "Rerouting this chat as its unassigned",
          "modes": [
            "RICH_MESSAGING"
          ],
          "content_type": "TEXT",
          "mime_type": "text/plain",
          "language_id": "c8f16db8-7a54-45f8-a102-8eafb4b094ea"
        }
      ],
      "uuid": "d634e73a-b6e6-4c8b-aa2c-c9546f5206af"
    },
    {
      "values": [
        {
          "value": "Agent assigned to this chat = @chat.assigned_to.name",
          "modes": [
            "RICH_MESSAGING"
          ],
          "content_type": "TEXT",
          "mime_type": "text/plain",
          "language_id": "c8f16db8-7a54-45f8-a102-8eafb4b094ea"
        }
      ],
      "uuid": "4184b057-7c8c-4bc2-b14a-57a86f14671b"
    },
    {
      "values": [
        {
          "value": "No agent assigned to this chat",
          "modes": [
            "RICH_MESSAGING"
          ],
          "content_type": "TEXT",
          "mime_type": "text/plain",
          "language_id": "c8f16db8-7a54-45f8-a102-8eafb4b094ea"
        }
      ],
      "uuid": "1ac727dc-fc27-459c-b01a-afe387a7fdc4"
    }
  ],
  "flows": [
    {
      "label": null,
      "name": "stack",
      "blocks": [
        {
          "label": null,
          "name": "search",
          "type": "Io.Turn.Webhook",
          "config": {
            "timeout": 5000,
            "mode": "sync",
            "body": null,
            "query": [
              [
                "slug",
                "plat_help_agent_greeting"
              ]
            ],
            "url": "https://content-repo-api-qa.prk-k8s.prd-p6t.org/api/v2/pages/",
            "headers": [
              [
                "Authorization",
                "Token @global.settings.contentrepo_qa_token"
              ]
            ],
            "method": "GET",
            "cache_ttl": 60000
          },
          "tags": [],
          "uuid": "c350b218-00f2-516c-89ea-a984ad8e2f72",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "search",
              "config": {},
              "test": "",
              "uuid": "73a2dc93-30c1-42a5-8c22-daac57080cfd",
              "destination_block": "002fc7de-ea1c-5f1e-b630-eb9e9b8e32af",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 30
                      },
                      "name": "SendTakeoverStart",
                      "uuid": "438c0b97-60ae-54d6-873d-c865147ab98d"
                    },
                    "card_item": {
                      "meta": {
                        "column": 3,
                        "line": 33
                      },
                      "type": "webhook",
                      "webhook": {}
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "page_id",
          "type": "Core.Case",
          "config": {},
          "tags": [],
          "uuid": "002fc7de-ea1c-5f1e-b630-eb9e9b8e32af",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "search.body.results[0].id",
              "config": {},
              "test": "",
              "uuid": "54a28e74-bb36-4702-99b7-7c53fe0126b4",
              "destination_block": "8133fdfb-b4be-5fe5-b344-981733a48631",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 30
                      },
                      "name": "SendTakeoverStart",
                      "uuid": "438c0b97-60ae-54d6-873d-c865147ab98d"
                    },
                    "card_item": {
                      "expression": {},
                      "meta": {
                        "column": 3,
                        "line": 42
                      },
                      "type": "expression"
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "page",
          "type": "Io.Turn.Webhook",
          "config": {
            "timeout": 5000,
            "mode": "sync",
            "body": null,
            "query": [
              [
                "whatsapp",
                "true"
              ]
            ],
            "url": "https://content-repo-api-qa.prk-k8s.prd-p6t.org/api/v2/pages/@page_id/",
            "headers": [
              [
                "Authorization",
                "Token @global.settings.contentrepo_qa_token"
              ]
            ],
            "method": "GET",
            "cache_ttl": 60000
          },
          "tags": [],
          "uuid": "8133fdfb-b4be-5fe5-b344-981733a48631",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "page",
              "config": {},
              "test": "",
              "uuid": "7af26f59-c8cc-45ed-9d29-bccc043c8e38",
              "destination_block": "2bfb8da8-3095-5ae8-b6be-6f5d2f299066",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 30
                      },
                      "name": "SendTakeoverStart",
                      "uuid": "438c0b97-60ae-54d6-873d-c865147ab98d"
                    },
                    "card_item": {
                      "meta": {
                        "column": 3,
                        "line": 44
                      },
                      "type": "webhook",
                      "webhook": {}
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "greeting_msg",
          "type": "Core.Case",
          "config": {},
          "tags": [],
          "uuid": "2bfb8da8-3095-5ae8-b6be-6f5d2f299066",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "page.body.body.text.value.message",
              "config": {},
              "test": "",
              "uuid": "04c84d01-696d-41e7-b527-ca88ee15c071",
              "destination_block": "5950c048-d5d0-5117-b188-2320b644c0e1",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 30
                      },
                      "name": "SendTakeoverStart",
                      "uuid": "438c0b97-60ae-54d6-873d-c865147ab98d"
                    },
                    "card_item": {
                      "expression": {},
                      "meta": {
                        "column": 3,
                        "line": 53
                      },
                      "type": "expression"
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "substituted_msg",
          "type": "Core.Case",
          "config": {},
          "tags": [],
          "uuid": "5950c048-d5d0-5117-b188-2320b644c0e1",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "substitute(greeting_msg, \"{operator_name}\", \"@chat.assigned_to.name\")",
              "config": {},
              "test": "",
              "uuid": "3a99bfc2-3241-440a-881f-6978387f0be3",
              "destination_block": "12780c7d-5476-5f96-b823-2c94fde2b138",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 30
                      },
                      "name": "SendTakeoverStart",
                      "uuid": "438c0b97-60ae-54d6-873d-c865147ab98d"
                    },
                    "card_item": {
                      "expression": {},
                      "meta": {
                        "column": 3,
                        "line": 54
                      },
                      "type": "expression"
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "send_takeover_start_text",
          "type": "MobilePrimitives.Message",
          "config": {
            "prompt": "ba6857c4-f443-4410-8c31-779a87cb2ee0"
          },
          "tags": [],
          "uuid": "12780c7d-5476-5f96-b823-2c94fde2b138",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "send_takeover_start_text",
              "config": {},
              "test": "",
              "uuid": "da7d1807-a737-48fa-a1b3-f7c444eb3092",
              "destination_block": null,
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 30
                      },
                      "name": "SendTakeoverStart",
                      "uuid": "438c0b97-60ae-54d6-873d-c865147ab98d"
                    },
                    "card_item": {
                      "meta": {
                        "column": 3,
                        "line": 56
                      },
                      "text": {},
                      "type": "text"
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "reroute_unassigned_text",
          "type": "MobilePrimitives.Message",
          "config": {
            "prompt": "d634e73a-b6e6-4c8b-aa2c-c9546f5206af"
          },
          "tags": [],
          "uuid": "b1ccb689-7655-5ead-a0a4-5fec18c7b87c",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "reroute_unassigned_text",
              "config": {},
              "test": "",
              "uuid": "9dbd1ddf-e40b-4960-b3fd-29b0f9c79fbd",
              "destination_block": null,
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 59
                      },
                      "name": "RerouteUnassigned",
                      "uuid": "a0a4ad5a-7d7b-5248-b8bf-748dbe419592"
                    },
                    "card_item": {
                      "meta": {
                        "column": 3,
                        "line": 60
                      },
                      "text": {},
                      "type": "text"
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "check_status_case",
          "type": "Core.Case",
          "config": {},
          "tags": [],
          "uuid": "e8f2f5d3-5d9e-5268-bdb2-d960bea5a0df",
          "ui_metadata": {},
          "exits": [
            {
              "default": false,
              "name": "Exit for check_status_case_condition_0",
              "config": {},
              "test": "is_nil_or_empty(chat.assigned_to)",
              "uuid": "d35e4667-e75f-479c-9359-084e4de4e025",
              "destination_block": "65166bda-99ae-5085-9586-5a095b7a84a7",
              "semantic_label": null,
              "vendor_metadata": {}
            },
            {
              "default": true,
              "name": "Exit for check_status_case_condition_1",
              "config": {},
              "test": null,
              "uuid": "9770fc17-0910-448b-8aa9-cb9a20b3b1df",
              "destination_block": "7d57a046-3f75-5f0e-877e-33f6347ebe72",
              "semantic_label": null,
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {}
        },
        {
          "label": null,
          "name": "check_status_case_condition_1_log",
          "type": "Core.Log",
          "config": {
            "message": "4184b057-7c8c-4bc2-b14a-57a86f14671b"
          },
          "tags": [],
          "uuid": "7d57a046-3f75-5f0e-877e-33f6347ebe72",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "Default exit to \"SendTakeoverStart\"",
              "config": {},
              "test": "",
              "uuid": "fe99a316-21ec-4b3c-a907-794572936597",
              "destination_block": "c350b218-00f2-516c-89ea-a984ad8e2f72",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 26
                      },
                      "name": "CheckStatus",
                      "uuid": "f86fa7a1-92cc-55e3-985c-40fd1cac62c4"
                    },
                    "card_item": {
                      "log": {},
                      "meta": {
                        "column": 3,
                        "line": 27
                      },
                      "type": "log"
                    },
                    "index": 1
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "check_status_case_condition_0_text",
          "type": "MobilePrimitives.Message",
          "config": {
            "prompt": "1ac727dc-fc27-459c-b01a-afe387a7fdc4"
          },
          "tags": [],
          "uuid": "65166bda-99ae-5085-9586-5a095b7a84a7",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "Default exit to \"RerouteUnassigned\"",
              "config": {},
              "test": "",
              "uuid": "49ac2a80-739b-4c9f-9ae6-aa65bdd9fc79",
              "destination_block": "b1ccb689-7655-5ead-a0a4-5fec18c7b87c",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": "is_nil_or_empty(chat.assigned_to)",
                      "meta": {
                        "column": 1,
                        "line": 22
                      },
                      "name": "CheckStatus",
                      "uuid": "e8f2f5d3-5d9e-5268-bdb2-d960bea5a0df"
                    },
                    "card_item": {
                      "meta": {
                        "column": 3,
                        "line": 23
                      },
                      "text": {},
                      "type": "text"
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "get_latest_msg",
          "type": "Io.Turn.Webhook",
          "config": {
            "timeout": 5000,
            "mode": "sync",
            "body": null,
            "query": [],
            "url": "https://whatsapp-praekelt-cloud.turn.io/v1/contacts/@contact.whatsapp_id/messages",
            "headers": [
              [
                "Authorization",
                "Bearer @global.settings.turn_qa_token"
              ],
              [
                "Accept",
                "application/vnd.v1+json"
              ],
              [
                "Content-Type",
                "application/json"
              ]
            ],
            "method": "GET",
            "cache_ttl": 60000
          },
          "tags": [],
          "uuid": "d632dfd9-31d5-5680-b3f2-2800478ffcd6",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "get_latest_msg",
              "config": {},
              "test": "",
              "uuid": "034faba4-f8a0-4ca3-a380-7bfa2c2ddcdc",
              "destination_block": "8a9dea5b-ee5e-5350-a7b5-a9b1a4a1cf9a",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 3
                      },
                      "name": "GetLatestMessage",
                      "uuid": "3773923e-6edb-52ce-a9f3-fb40e2920783"
                    },
                    "card_item": {
                      "meta": {
                        "column": 3,
                        "line": 4
                      },
                      "type": "webhook",
                      "webhook": {}
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        },
        {
          "label": null,
          "name": "chat",
          "type": "Core.Case",
          "config": {},
          "tags": [],
          "uuid": "8a9dea5b-ee5e-5350-a7b5-a9b1a4a1cf9a",
          "ui_metadata": {
            "canvas_coordinates": {
              "x": 0,
              "y": 0
            }
          },
          "exits": [
            {
              "default": true,
              "name": "get_latest_msg.body.chat",
              "config": {},
              "test": "",
              "uuid": "4eb48c95-bbce-4291-8a62-62c832e20ea1",
              "destination_block": "e8f2f5d3-5d9e-5268-bdb2-d960bea5a0df",
              "semantic_label": "",
              "vendor_metadata": {}
            }
          ],
          "semantic_label": null,
          "vendor_metadata": {
            "io": {
              "turn": {
                "stacks_dsl": {
                  "0.1.0": {
                    "card": {
                      "condition": null,
                      "meta": {
                        "column": 1,
                        "line": 3
                      },
                      "name": "GetLatestMessage",
                      "uuid": "3773923e-6edb-52ce-a9f3-fb40e2920783"
                    },
                    "card_item": {
                      "expression": {},
                      "meta": {
                        "column": 3,
                        "line": 19
                      },
                      "type": "expression"
                    },
                    "index": 0
                  }
                }
              }
            }
          }
        }
      ],
      "last_modified": "2024-08-27T08:03:16.159696Z",
      "uuid": "08ea1b62-426f-4cc6-9c20-27e67e7ff37f",
      "languages": [
        {
          "id": "c8f16db8-7a54-45f8-a102-8eafb4b094ea",
          "label": "English",
          "variant": null,
          "bcp_47": null,
          "iso_639_3": "eng"
        }
      ],
      "interaction_timeout": 300,
      "first_block_id": "d632dfd9-31d5-5680-b3f2-2800478ffcd6",
      "vendor_metadata": {},
      "supported_modes": [
        "RICH_MESSAGING"
      ],
      "exit_block_id": ""
    }
  ],
  "vendor_metadata": {},
  "specification_version": "1.0.0-rc3"
}